'use strict';

require('reflect-metadata');
var pt = require('typedi');
var nodeFetch = require('node-fetch');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var pt__default = /*#__PURE__*/_interopDefault(pt);

var K=Object.defineProperty,Y=Object.defineProperties,Z=Object.getOwnPropertyDescriptor,Q=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var B=(r,t,e)=>t in r?K(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,c=(r,t)=>{for(var e in t||(t={}))X.call(t,e)&&B(r,e,t[e]);if(G)for(var e of G(t))$.call(t,e)&&B(r,e,t[e]);return r},g=(r,t)=>Y(r,Q(t));var l=(r,t,e,s)=>{for(var a=s>1?void 0:s?Z(t,e):t,m=r.length-1,u;m>=0;m--)(u=r[m])&&(a=(s?u(t,e,a):u(a))||a);return s&&a&&K(t,e,a),a};var o=(r,t,e)=>new Promise((s,a)=>{var m=f=>{try{x(e.next(f));}catch(F){a(F);}},u=f=>{try{x(e.throw(f));}catch(F){a(F);}},x=f=>f.done?s(f.value):Promise.resolve(f.value).then(m,u);x((e=e.apply(r,t)).next());});var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i={API_VERSION:"/v1",LOGIN:"/auth/login",REGISTER:"/auth/create-account",ACCOUNT_VERIFY:"/auth/account/verify",RESEND_VERIFY_LINK:"/auth/account/verify",VALIDATE_PASSWORD_TOKEN:"/auth/validate/password",RESET_PASSWORD:"/auth/password/reset",CHANGE_PASSWORD:"/auth/password/change",COLLECTION:"/collection",COLLECTION_TYPE:"/collection-type",COLLECTION_MANY:"/collection/many",BOOKMARK:"/bookmark",NOTIFICATION_FETCH:"/notifications/",NOTIFICATION_MARK_ALL:"/notifications/mark/all",NOTIFICATION_MARK_ONE:"/notifications/mark",ACCOUNT:"/account",ACCOUNT_ONBOARD:"/account/onboard",ACCOUNT_UPDATE:"/account/update",ACCOUNT_PASSWORD:"/account/password/change",ACCOUNT_TWO_INIT:"/account/initiate/2fa",ACCOUNT_TWO_ACTIVATE:"/account/activate/2fa",ACCOUNT_TWO_DEACTIVATE:"/account/deactivate/2fa",ACCOUNT_LOGOUT:"/account/logout",WALLET_TRANSACTIONS:"/wallet/transactions",A_WALLET_TRANSACTION:"/wallet/transaction",WALLET_EXCHANGE:"/wallet/exchange",WALLET_DATA:"/wallet/data",WALLET_STATS:"/wallet/stats",WALLET_AGGREGATE_STATS:"/wallet/aggregate/stats",WALLETS:"/wallet",SINGLE_WALLET:"/wallet/coin",FILE_UPLOAD:"/upload/",ADD_REVIEW:"/reviews/",CREATE_WITHDRAWAL:"/withdrawals/",FETCH_WITHDRAWALS:"/withdrawals/",CREATE_SESSION:"/user-verification/veriff/session/new",SEND_SESSION_MEDIA:"/user-verification/veriff/session/media",SESSION_ATTEMPTS:"/user-verification/veriff/session/attempts",USER_VERIFICATION:"/user-verification/user",DELETE_SESSION:"/user-verification/veriff/session/delete",GET_USER_MESSAGES:"/chat/",CREATE_CONNECTION_FILTER:"/conn-filter/",GET_CONNECTION_FILTER:"/conn-filter/user",UPDATE_CONNECTION_FILTER:"/conn-filter/"};var U=new pt.Token("PAKT_CONFIG"),W=new pt.Token("AUTH_TOKEN"),v=new pt.Token("TEMP_TOKEN");var V="0.1.10";var tt=(e=>(e.SUCCESS="SUCCESS",e.ERROR="ERROR",e))(tt||{}),n={tryFail:r=>o(void 0,null,function*(){try{return {data:yield r(),status:"SUCCESS"}}catch(t){let e=n.toErrorWithMessage(t);return {data:null,status:"ERROR",message:e?e.message:["Internal Server Error"],code:e.code}}}),formatErrorMsg:r=>r.replace("attr.",""),toErrorWithMessage:r=>{var t;if(typeof r=="string")try{let e=JSON.parse(r);return e.data instanceof Array&&e.data.length>0?{message:e.data.map(s=>n.formatErrorMsg(s)),code:e.errorCode}:{message:[(t=e.message)!=null?t:r],code:e.errorCode}}catch(e){}if(n.isErrorWithMessage(r))return {message:[r.message]};try{return {message:[JSON.stringify(r,null,2)]}}catch(e){return {message:[String(r)]}}},isErrorWithMessage(r){return typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"}},d=(r,t)=>{let e="?";return Object.keys(t).map(s=>{e=e+`${s}=${t[s]}&`;}),r+e};var rt=(r,t)=>import('node-fetch').then(({default:e})=>e(r,t)),p=class{constructor(t){this.id=t;}get(t){return o(this,null,function*(){return this.request(g(c({},t),{method:"GET"}))})}post(t){return o(this,null,function*(){return this.request(g(c({},t),{method:"POST"}))})}patch(t){return o(this,null,function*(){return this.request(g(c({},t),{method:"PATCH"}))})}put(t){return o(this,null,function*(){return this.request(g(c({},t),{method:"PUT"}))})}delete(t){return o(this,null,function*(){return this.request(g(c({},t),{method:"DELETE"}))})}request(x){return o(this,arguments,function*({path:t,params:e,body:s,method:a},m=0,u){let{verbose:f}=pt.Container.of(this.id).get(U),F=u||this.getUrl({path:t,params:e}),M={headers:yield this.headers(m),method:a,body:s?JSON.stringify(s):void 0},J=Date.now();f&&console.debug(new Date().toISOString(),"SDK Request: ",M.method,F,M.body);try{return yield rt(F,M).then(D=>o(this,null,function*(){let j=Date.now()-J;f&&console.log(new Date().toISOString(),`SDK Response received in ${j}ms: `,D.status,yield D.clone().text());let q=yield D.json();return g(c({},q),{code:D.status})}))}catch(D){return f&&console.warn(new Date().toISOString(),"Error: ",D),Promise.reject(D)}})}getUrl({path:t,params:e}){let s=pt.Container.of(this.id).get(U),a=i.API_VERSION+t,m=new URL(a||"",s.baseUrl);return console.log(a,m),e&&Object.keys(e).filter(u=>!!e[u]).forEach(u=>m.searchParams.append(u,`${e[u]}`)),s.testnet&&m.searchParams.append("type","testnet"),m.toString()}headers(t){return o(this,null,function*(){let e={},s=pt.Container.of(this.id).get(U),a=pt.Container.of(this.id).get(W);a&&(e={Authorization:`Bearer ${a}`});let m=new nodeFetch.Headers(c({"Content-Type":"application/json","x-pkt-sdk-version":V,"x-pkt-sdk-product":"JS","x-pkt-testnet":`${s.testnet}`,"x-pkt-sdk-retry":`${t}`},e));return s.token&&m.append("x-api-key",s.token),m})}};p=l([pt.Service({factory:r=>new p(r.id),transient:!0})],p);exports.AccountModule=class h{constructor(t){this.id=t,this.connector=pt.Container.of(this.id).get(p);}getUser(){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:i.ACCOUNT})).data}))})}onboardEndpoint(t,e,s){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let a={skillCategory:t,profileImage:e,type:s};return (yield this.connector.post({path:i.ACCOUNT_ONBOARD,body:a})).data}))})}updateAccount(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e=c({},t);return (yield this.connector.patch({path:i.ACCOUNT_UPDATE,body:e})).data}))})}changePassword(t,e){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let s={oldPassword:t,newPassword:e};return (yield this.connector.put({path:i.ACCOUNT_PASSWORD,body:s})).data}))})}initate2FA(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e={type:t};return (yield this.connector.post({path:i.ACCOUNT_PASSWORD,body:e})).data}))})}active2FA(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e={code:t};return (yield this.connector.post({path:i.ACCOUNT_TWO_ACTIVATE,body:e})).data}))})}deactive2FA(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e={code:t};return (yield this.connector.post({path:i.ACCOUNT_TWO_DEACTIVATE,body:e})).data}))})}logout(){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.post({path:i.ACCOUNT_LOGOUT})).data}))})}};exports.AccountModule=l([pt.Service({factory:r=>new exports.AccountModule(r.id),transient:!0})],exports.AccountModule);exports.AuthenticationModule=class A{constructor(t){this.id=t,this.connector=pt.Container.of(this.id).get(p);}login(t,e){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let s={email:t,password:e},a=yield this.connector.post({path:i.LOGIN,body:s});return a.data.tempToken?pt.Container.of(this.id).set(v,a.data.tempToken.token):pt.Container.of(this.id).set(W,a.data.token),a.data}))})}register(t,e,s,a){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let m={firstName:t,lastName:e,email:s,password:a},u=yield this.connector.post({path:i.REGISTER,body:m});return u.data.tempToken.token&&pt.Container.of(this.id).set(v,u.data.tempToken.token),u.data}))})}verifyAccount(t,e){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let s={tempToken:t,token:e};return yield this.connector.post({path:i.ACCOUNT_VERIFY,body:s})}))})}resendVerifyLink(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e={email:t},s=yield this.connector.post({path:i.RESET_PASSWORD,body:e});return s.data.tempToken&&pt.Container.of(this.id).set(v,s.data.tempToken.token),s.data}))})}resetPassword(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e={email:t};return (yield this.connector.post({path:i.RESET_PASSWORD,body:e})).data}))})}changePassword(t,e){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let s={token:t,password:e};return (yield this.connector.post({path:i.CHANGE_PASSWORD,body:s})).data}))})}validatePasswordToken(t){return n.tryFail(()=>o(this,null,function*(){let e={token:t};return (yield this.connector.post({path:i.VALIDATE_PASSWORD_TOKEN,body:e})).data}))}};exports.AuthenticationModule=l([pt.Service({factory:r=>new exports.AuthenticationModule(r.id),transient:!0})],exports.AuthenticationModule);exports.BookMarkModule=class R{constructor(t){this.id=t,this.connector=pt.Container.of(this.id).get(p);}getAll(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e=d(i.BOOKMARK,t);return (yield this.connector.get({path:e})).data}))})}getById(t,e){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let s=d(i.BOOKMARK+"/"+t,e);return (yield this.connector.get({path:s})).data}))})}create(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e=c({},t);return (yield this.connector.post({path:i.BOOKMARK,body:e})).data}))})}delete(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.delete({path:i.BOOKMARK+"/"+t})).data}))})}};exports.BookMarkModule=l([pt.Service({factory:r=>new exports.BookMarkModule(r.id),transient:!0})],exports.BookMarkModule);exports.ChatModule=class y{constructor(t){this.id=t,this.connector=pt__default.default.of(this.id).get(p);}getUserMessages(){return n.tryFail(()=>o(this,null,function*(){let t=d(i.GET_USER_MESSAGES,null);return (yield this.connector.get({path:t})).data}))}};exports.ChatModule=l([pt.Service({factory:r=>new exports.ChatModule(r.id),transient:!0})],exports.ChatModule);exports.CollectionModule=class E{constructor(t){this.id=t,this.connector=pt.Container.of(this.id).get(p);}getAll(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e=d(i.COLLECTION,t);return (yield this.connector.get({path:e})).data}))})}getById(t,e){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let s=d(i.COLLECTION+"/"+t,e);return (yield this.connector.get({path:s})).data}))})}getTypes(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e=d(i.COLLECTION_TYPE,t);return (yield this.connector.get({path:e})).data}))})}create(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e=c({},t);return (yield this.connector.post({path:i.COLLECTION,body:e})).data}))})}createMany(t){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){let e=c({},t);return (yield this.connector.post({path:i.COLLECTION,body:e})).data}))})}};exports.CollectionModule=l([pt.Service({factory:r=>new exports.CollectionModule(r.id),transient:!0})],exports.CollectionModule);exports.ConnectionFilterModule=class C{constructor(t){this.id=t,this.connector=pt__default.default.of(this.id).get(p);}create(t){return n.tryFail(()=>o(this,null,function*(){let e=c({},t);return (yield this.connector.post({path:i.CREATE_CONNECTION_FILTER,body:e})).data}))}update(t){return n.tryFail(()=>o(this,null,function*(){let e=c({},t);return (yield this.connector.patch({path:i.UPDATE_CONNECTION_FILTER,body:e})).data}))}getForAUser(){let t=d(i.GET_CONNECTION_FILTER,null);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:t})).data}))}};exports.ConnectionFilterModule=l([pt.Service({factory:r=>new exports.ConnectionFilterModule(r.id),transient:!0})],exports.ConnectionFilterModule);exports.NotificationModule=class S{constructor(t){this.id=t,this.connector=pt.Container.of(this.id).get(p);}getAll(t){return o(this,null,function*(){let e=d(i.NOTIFICATION_FETCH,t);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:e})).data}))})}markAll(){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.post({path:i.NOTIFICATION_MARK_ALL})).data}))})}markOneAsRead(t){return o(this,null,function*(){let e=d(i.NOTIFICATION_MARK_ONE+"/"+t,null);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.post({path:e})).data}))})}};exports.NotificationModule=l([pt.Service({factory:r=>new exports.NotificationModule(r.id),transient:!0})],exports.NotificationModule);exports.ReviewModule=class I{constructor(t){this.id=t,this.connector=pt__default.default.of(this.id).get(p);}addReview(t){let e=c({},t);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.post({path:i.ADD_REVIEW,body:e})).data}))}};exports.ReviewModule=l([pt.Service({factory:r=>new exports.ReviewModule(r.id),transient:!0})],exports.ReviewModule);exports.UploadModule=class P{constructor(t){this.id=t,this.connector=pt__default.default.of(this.id).get(p);}fileUpload(t){let e=c({},t);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.post({path:i.FILE_UPLOAD,body:e})).data}))}};exports.UploadModule=l([pt.Service({factory:r=>new exports.UploadModule(r.id),transient:!0})],exports.UploadModule);exports.UserVerificationModule=class O{constructor(t){this.id=t,this.connector=pt__default.default.of(this.id).get(p);}createSession(t){let e=c({},t);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.post({path:i.CREATE_SESSION,body:e})).data}))}sendSessionMedia(t){let e=c({},t);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.post({path:i.SEND_SESSION_MEDIA,body:e})).data}))}getSessionAttempts(){let t=d(i.SESSION_ATTEMPTS,null);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:t})).data}))}getUserVerifications(){let t=d(i.USER_VERIFICATION,null);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:t})).data}))}};exports.UserVerificationModule=l([pt.Service({factory:r=>new exports.UserVerificationModule(r.id),transient:!0})],exports.UserVerificationModule);exports.WalletModule=class w{constructor(t,e){this.id=t,this.connector=pt__default.default.of(this.id).get(p),this.coin=e;}getTransactions(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:i.WALLET_TRANSACTIONS})).data}))}getATransaction(t){let e=d(i.A_WALLET_TRANSACTION+"/"+t,null);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:e})).data}))}getTransactionStats(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:i.WALLET_STATS})).data}))}getAggregateTransactionStats(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:i.WALLET_AGGREGATE_STATS})).data}))}getWalletData(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:i.WALLET_AGGREGATE_STATS})).data}))}getWallets(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:i.WALLETS})).data}))}getSingleWallet(t){let e=d(i.SINGLE_WALLET+"/"+t,null);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:e})).data}))}getExchange(){return o(this,null,function*(){return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:i.WALLET_EXCHANGE})).data}))})}};exports.WalletModule=l([pt.Service({factory:r=>new exports.WalletModule(r.id,r.coin)})],exports.WalletModule);exports.WithdrawalModule=class N{constructor(t){this.id=t,this.connector=pt__default.default.of(this.id).get(p);}createWithdrawal(t){return n.tryFail(()=>o(this,null,function*(){let e=c({},t);return (yield this.connector.post({path:i.CREATE_WITHDRAWAL,body:e})).data}))}fetchWithdrawal(t){let e=d(i.FETCH_WITHDRAWALS,t);return n.tryFail(()=>o(this,null,function*(){return (yield this.connector.get({path:e})).data}))}};exports.WithdrawalModule=l([pt.Service({factory:r=>new exports.WithdrawalModule(r.id)})],exports.WithdrawalModule);exports.PaktSDK=class _{constructor(t){this.auth=pt.Container.of(t).get(exports.AuthenticationModule),this.collection=pt.Container.of(t).get(exports.CollectionModule),this.account=pt.Container.of(t).get(exports.AccountModule),this.notifications=pt.Container.of(t).get(exports.NotificationModule),this.file=pt.Container.of(t).get(exports.UploadModule),this.wallet=pt.Container.of(t).get(exports.WalletModule),this.withdrawal=pt.Container.of(t).get(exports.WithdrawalModule),this.review=pt.Container.of(t).get(exports.ReviewModule),this.bookmark=pt.Container.of(t).get(exports.BookMarkModule),this.userVerification=pt.Container.of(t).get(exports.UserVerificationModule),this.chat=pt.Container.of(t).get(exports.ChatModule),this.connectionFilter=pt.Container.of(t).get(exports.ConnectionFilterModule);}static init(t){return o(this,null,function*(){let e=c({},t),s=exports.PaktSDK.generateRandomString();return pt.Container.of(s).set(U,e),pt.Container.of(s).set(W,""),pt.Container.of(s).set(v,""),new exports.PaktSDK(s)})}static generateRandomString(){let t=H,e="";for(let s=0;s<60;s++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}};exports.PaktSDK=l([pt.Service({transient:!0})],exports.PaktSDK);

exports.API_PATHS = i;
exports.AUTH_TOKEN = W;
exports.CHARACTERS = H;
exports.ErrorUtils = n;
exports.PAKT_CONFIG = U;
exports.Status = tt;
exports.TEMP_TOKEN = v;
exports.parseUrlWithQuery = d;
